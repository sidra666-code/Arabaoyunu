<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Sonsuz Hill Climb</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    html, body {
      height: 100%;
      overflow: hidden;
      font-family: sans-serif;
      /* Yakƒ±nla≈ütƒ±rmayƒ± kapatmak i√ßin dokunmatik aksiyonlarƒ± kƒ±sƒ±tla */
      touch-action: pan-x pan-y;
    }

    #orientationWarning {
      display: none;
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: #000;
      color: white;
      font-size: 24px;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 9999;
    }

    #game {
      width: 100vw;
      height: 100vh;
      background: linear-gradient(to top, #87ceeb, #e0f7ff);
      overflow: hidden;
      position: relative;
      /* Ba≈ülangƒ±√ßta gizli olacak */
      display: none;
    }

    #loadingScreen {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: #333; /* Koyu gri arka plan */
      color: white;
      font-size: 28px;
      display: flex;
      flex-direction: column; /* √ñƒüeleri dikeyde sƒ±rala */
      align-items: center;
      justify-content: center;
      z-index: 10000; /* Her ≈üeyin √ºzerinde olsun */
    }

    #loadingText {
      margin-bottom: 20px;
    }

    /* Yeni "Ba≈üla" butonu stilleri */
    #startButton {
      /* From Uiverse.io by Smit-Prajapati */
      --main-color: rgb(46, 213, 115);
      --main-bg-color: rgba(46, 213, 116, 0.36);
      --pattern-color: rgba(46, 213, 116, 0.073);

      filter: hue-rotate(0deg);

      cursor: pointer;
      text-transform: uppercase;
      letter-spacing: 0.3rem; /* Biraz k√º√ß√ºltt√ºm */
      background: radial-gradient(
          circle,
          var(--main-bg-color) 0%,
          rgba(0, 0, 0, 0) 95%
        ),
        linear-gradient(var(--pattern-color) 1px, transparent 1px),
        linear-gradient(to right, var(--pattern-color) 1px, transparent 1px);
      background-size:
        cover,
        15px 15px,
        15px 15px;
      background-position:
        center center,
        center center,
        center center;
      border-image: radial-gradient(
          circle,
          var(--main-color) 0%,
          rgba(0, 0, 0, 0) 100%
        )
        1;
      border-width: 1px 0 1px 0;
      color: var(--main-color);
      padding: 0.8rem 2.5rem; /* Biraz k√º√ß√ºltt√ºm */
      font-weight: 700;
      font-size: 1.2rem; /* Biraz k√º√ß√ºltt√ºm */
      transition: background-size 0.2s ease-in-out;
      display: none; /* Ba≈ülangƒ±√ßta gizli kalacak */
    }

    #startButton:hover {
      background-size:
        cover,
        10px 10px,
        10px 10px;
    }

    #startButton:active {
      filter: hue-rotate(250deg);
    }

    .cloud {
      position: absolute;
      top: 0;
      font-size: 40px;
      z-index: 1;
      animation: moveCloudInstance 60s linear infinite;
    }

    @keyframes moveCloudInstance {
      0% { transform: translateX(0); }
      100% { transform: translateX(-200vw); }
    }

    #world {
      position: absolute;
      bottom: 0;
      display: flex;
      height: 100px;
      left: 0;
      z-index: 2;
    }

    .groundSegment {
      width: 200px;
      height: 100px;
      background: #4CAF50;
    }

    .tree {
      position: absolute;
      bottom: 100px;
      font-size: 40px;
      z-index: 3;
    }

    #car {
      font-size: 60px;
      position: absolute;
      bottom: 100px;
      left: 50%;
      transform: translateX(-50%) scaleX(-1);
      z-index: 4;
    }

    .controls {
      position: absolute;
      bottom: 120px;
      width: 100%;
      display: flex;
      justify-content: space-between;
      padding: 0 20px;
      box-sizing: border-box;
      z-index: 5;
    }

    .btn {
      background: rgba(0,0,0,0.6);
      color: white;
      padding: 12px 18px;
      border-radius: 10px;
      font-size: 18px;
      border: none;
      user-select: none;
      touch-action: none;
    }
  </style>
</head>
<body>

<div id="orientationWarning">L√ºtfen telefonu yatay √ßevirin üì±‚û°Ô∏èüì±</div>

<div id="loadingScreen">
  <div id="loadingText">Y√ºkleniyor...</div>
  <button id="startButton">BA≈ûLA</button>
</div>

<div id="game">
  <div id="world"></div>
  <div id="car">üöó</div>
  <div class="controls">
    <button id="leftBtn" class="btn">‚óÄÔ∏è</button>
    <button id="rightBtn" class="btn">‚ñ∂Ô∏è</button>
  </div>
</div>

<script>
  const world = document.getElementById("world");
  const leftBtn = document.getElementById("leftBtn");
  const rightBtn = document.getElementById("rightBtn");
  const game = document.getElementById("game");
  const car = document.getElementById("car");
  const loadingScreen = document.getElementById("loadingScreen");
  const loadingText = document.getElementById("loadingText");
  const startButton = document.getElementById("startButton");

  const carSound = new Audio('araba.mp3');
  carSound.loop = true;
  carSound.volume = 0.8; // Ses seviyesini sabit tut

  let offset = 0;
  let velocity = 0;
  let acceleration = 0;
  const friction = 0.95;

  let isPlayingSound = false;

  const treeList = [];
  let lastTreePosition = 0;

  const cloudList = [];
  let lastCloudPosition = 0;
  const cloudSpawnMinDistance = 150;
  const cloudSpawnMaxDistance = 400;

  function createGround() {
    const segment = document.createElement("div");
    segment.className = "groundSegment";
    world.appendChild(segment);
  }

  function createTree(globalX) {
    const tree = document.createElement("div");
    tree.className = "tree";
    tree.dataset.globalX = globalX;
    tree.textContent = ["üå≥", "üå¥", "üå≤"][Math.floor(Math.random() * 3)];
    game.appendChild(tree);
    treeList.push(tree);
  }

  function createCloud(globalX) {
    const cloud = document.createElement("div");
    cloud.className = "cloud";
    cloud.dataset.globalX = globalX;
    cloud.textContent = "‚òÅÔ∏è";

    const randomSize = Math.random() * 30 + 30;
    const randomOpacity = Math.random() * 0.5 + 0.3;
    const randomY = Math.random() * (window.innerHeight / 3);

    cloud.style.fontSize = randomSize + "px";
    cloud.style.opacity = randomOpacity;
    cloud.style.top = randomY + "px";

    game.appendChild(cloud);
    cloudList.push(cloud);
  }

  function updateTrees() {
    for (let tree of treeList) {
      const globalX = parseFloat(tree.dataset.globalX);
      const screenX = globalX - offset;
      tree.style.left = screenX + "px";

      if (screenX < -100) {
        tree.remove();
        treeList.splice(treeList.indexOf(tree), 1);
      }
    }
  }

  function updateClouds() {
    for (let cloud of cloudList) {
      const globalX = parseFloat(cloud.dataset.globalX);
      const screenX = globalX - offset * 0.2;
      cloud.style.left = screenX + "px";

      if (screenX < -200) {
        cloud.remove();
        cloudList.splice(cloudList.indexOf(cloud), 1);
      }
    }
  }

  function update() {
    velocity += acceleration;
    velocity *= friction;
    offset -= velocity;
    world.style.left = -offset + "px";

    const neededSegments = Math.ceil((Math.abs(offset) + window.innerWidth) / 200);
    while (world.children.length < neededSegments) {
      createGround();
    }

    const currentGroundEnd = offset + world.children.length * 200;
    while (currentGroundEnd - lastTreePosition >= 300) {
      createTree(lastTreePosition + Math.random() * 200 + 100);
      lastTreePosition = parseFloat(treeList[treeList.length - 1].dataset.globalX);
    }

    const screenRightEdge = offset + window.innerWidth;
    if (screenRightEdge - lastCloudPosition > cloudSpawnMinDistance) {
      const spawnX = lastCloudPosition + Math.random() * (cloudSpawnMaxDistance - cloudSpawnMinDistance) + cloudSpawnMinDistance;
      createCloud(spawnX);
      lastCloudPosition = spawnX;
    }

    updateTrees();
    updateClouds();

    requestAnimationFrame(update);
  }

  // Fonksiyon: Sesi ba≈ülat
  function startCarSound() {
    if (!isPlayingSound) {
      carSound.play().catch(e => console.log("Ses √ßalma hatasƒ±:", e));
      isPlayingSound = true;
    }
  }

  // Fonksiyon: Sesi durdur
  function stopCarSound() {
    if (isPlayingSound) {
      carSound.pause();
      carSound.currentTime = 0;
      isPlayingSound = false;
    }
  }

  function hold(dir) {
    acceleration = dir;
    clearInterval(window.holdInt);
    window.holdInt = setInterval(() => acceleration = dir, 16);
    startCarSound();
  }

  function stop() {
    clearInterval(window.holdInt);
    acceleration = 0;
    stopCarSound();
  }

  setup(leftBtn, 0.5);
  setup(rightBtn, -0.5);

  function setup(btn, dir) {
    btn.addEventListener("touchstart", e => { e.preventDefault(); hold(dir); });
    btn.addEventListener("touchend", stop);
    btn.addEventListener("mousedown", () => hold(dir));
    btn.addEventListener("mouseup", stop);
    btn.addEventListener("mouseleave", stop);
  }

  function checkOrientation() {
    const warning = document.getElementById("orientationWarning");
    warning.style.display = window.innerHeight > window.innerWidth ? "flex" : "none";
  }
  window.addEventListener("resize", checkOrientation);
  window.addEventListener("orientationchange", checkOrientation);
  checkOrientation();

  // Y√ºkleme ekranƒ±nƒ± ve oyunu ba≈ülatma mantƒ±ƒüƒ±
  document.addEventListener('DOMContentLoaded', () => {
    // Ses dosyasƒ±nƒ±n y√ºklenmesini bekleyebiliriz
    carSound.addEventListener('canplaythrough', () => {
        loadingText.textContent = "Hazƒ±r!";
        startButton.style.display = "block"; // Ba≈ülat d√ºƒümesini g√∂ster
    }, { once: true }); // Sadece bir kez tetiklensin

    // Eƒüer ses dosyasƒ± hƒ±zlƒ± y√ºklenirse veya bir hata olursa, belirli bir s√ºre sonra da Ba≈üla d√ºƒümesini g√∂sterebiliriz.
    setTimeout(() => {
        if (startButton.style.display === "none") { // Eƒüer hen√ºz g√∂sterilmemi≈üse
            loadingText.textContent = "Hazƒ±r!";
            startButton.style.display = "block";
        }
    }, 2000); // 2 saniye sonra g√∂ster (istersen bu s√ºreyi deƒüi≈ütirebilirsin)

    startButton.addEventListener('click', () => {
        loadingScreen.style.display = "none"; // Y√ºkleme ekranƒ±nƒ± gizle
        game.style.display = "block"; // Oyun ekranƒ±nƒ± g√∂ster
        // Oyunun ba≈ülangƒ±√ß ayarlarƒ±nƒ± burada yap
        for(let i=0; i < Math.ceil(window.innerWidth / 200) + 2; i++) {
            createGround();
        }
        for(let i = 0; i < 5; i++) {
            createTree(i * 300 + Math.random() * 100);
            lastTreePosition = parseFloat(treeList[treeList.length - 1].dataset.globalX);
        }
        for(let i = 0; i < 5; i++) {
            createCloud(i * 400 + Math.random() * 200);
            lastCloudPosition = parseFloat(cloudList[cloudList.length - 1].dataset.globalX);
        }
        update(); // Oyun d√∂ng√ºs√ºn√º ba≈ülat
    });
  });
</script>

</body>
</html>
